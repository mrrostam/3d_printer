# This file contains pin mappings for the stock Sovol SV06
# To use this config, during "make menuconfig" select the
# STM32F103 with a "28KiB bootloader" and serial (on USART1 PA10/PA9) communication.
# Also, since it is using the GD32F103, please select Disable SWD at startup
#
# Flash this firmware by copying "out/klipper.bin" to a SD card and
# turning on the printer with the card inserted. The firmware
# filename must end in ".bin" and must not match the last filename
# that was flashed.
#
# See docs/Config_Reference.md for a description of parameters.

[include mainsail.cfg]
[include fluidd.cfg]

[mcu]
serial: /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
restart_method: command

[printer]
kinematics: cartesian

[extruder]
rotation_distance: 4.55186  # This value should be calibrated
nozzle_diameter: 0.400
control: pid
pid_kd: 86.991
pid_kp: 21.479
pid_ki: 1.326

[heater_bed]
heater_pin: PA2
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PC4
min_temp: 0
max_temp: 110
control: pid
pid_kp: 64.440
pid_ki: 0.773
pid_kd: 1343.571

[fan]
pin: PA0

[probe]
pin: PB1
x_offset: 27
y_offset: -20
#z_offset: 0
samples: 3
samples_result: median
samples_tolerance: 0.01
samples_tolerance_retries: 5

[axis_twist_compensation]
calibrate_start_x: 27 # probe x coor at furthest left ; abs(x_offset)
calibrate_end_x: 192 # probe x coor at furthest right ; (x.position_max - abs(x_offset) - 1)
calibrate_y: 110

[bed_screws]
screw1_name: front left
screw1: 26.5, 31
screw2_name: front right
screw2: 196.75, 31
screw3_name: back right
screw3: 196.75, 201
screw4_name: back left
screw4: 26.5, 201

[screws_tilt_adjust]
screw1_name: center
screw1: 84.50, 135
screw2_name: front left
screw2: 0, 51
screw3_name: front right
screw3: 169.75, 51
screw4_name: back right
screw4: 169.75, 221
screw5_name: back left
screw5: 0, 221
horizontal_move_z: 10
screw_thread: CCW-M4

[output_pin beeper]
pin: PC6
value: 0
shutdown_value: 0
pwm: True
cycle_time: 0.0005 ; Default beeper tone in kHz. 1 / 0.0005 = 2000Hz (2kHz)

# [filament_switch_sensor filament_sensor]
# switch_pin: !PA4 # "Pulled-high"
# pause_on_runout: True
# insert_gcode:
#     M117 Insert Detected
#     { action_respond_info("Insert Detected") }
# runout_gcode:
#     M117 Runout Detected
#     { action_respond_info("Runout Detected") }
#     CONDITIONAL_BEEP i=3 dur=300 freq=400

# [idle_timeout]
# timeout: 1800

[virtual_sdcard]
path: ~/printer_data/gcodes

[exclude_object]
[pause_resume]
[display_status]

[include modules/printing-profiles/basic.cfg]        # Well balanced mode
# [include modules/printing-profiles/stealthchop.cfg]  # Use Stealthchop with interpolation
# [include modules/printing-profiles/performance.cfg]  # Faster, louder

[include modules/options.cfg]

# [mcu pico]
# serial: /dev/serial/by-id/usb-Klipper_rp2040_454741505B8D6ACA-if00

# [adxl345]
# spi_bus: spi0a
# cs_pin: pico:gpio1

# [resonance_tester]
# accel_chip: adxl345
# probe_points:
#     100,100,20 # an example

[input_shaper]
shaper_freq_x: 56
shaper_freq_y: 48
shaper_type: mzv

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  -0.087188, -0.083438, -0.060938, -0.040938, -0.051563, -0.056563, -0.085625, -0.097188, -0.110000, -0.094688, -0.150625
#*# 	  -0.105625, -0.105625, -0.083438, -0.072188, -0.083750, -0.088438, -0.118438, -0.135000, -0.153438, -0.133125, -0.209688
#*# 	  -0.095625, -0.078125, -0.053438, -0.040625, -0.048125, -0.044063, -0.064688, -0.079063, -0.111875, -0.111250, -0.195000
#*# 	  -0.086563, -0.068438, -0.042188, -0.028125, -0.035625, -0.031563, -0.046563, -0.057188, -0.085313, -0.082813, -0.153750
#*# 	  -0.096563, -0.082813, -0.059688, -0.046563, -0.051250, -0.044688, -0.057500, -0.063750, -0.082813, -0.081563, -0.128125
#*# 	  -0.097500, -0.086875, -0.065000, -0.054375, -0.058438, -0.048438, -0.057500, -0.066875, -0.085313, -0.079063, -0.127188
#*# 	  -0.092500, -0.081875, -0.060000, -0.043438, -0.045625, -0.039063, -0.053125, -0.063125, -0.084063, -0.073750, -0.132500
#*# 	  -0.085938, -0.080938, -0.058125, -0.042500, -0.050000, -0.031875, -0.047500, -0.061563, -0.083125, -0.073125, -0.127188
#*# 	  -0.078750, -0.070938, -0.049063, -0.040000, -0.040625, -0.027500, -0.047500, -0.060625, -0.084375, -0.071563, -0.111875
#*# 	  -0.057500, -0.055000, -0.035938, -0.026875, -0.032188, -0.020000, -0.041563, -0.057500, -0.078438, -0.064688, -0.105000
#*# 	  -0.024063, -0.027813, -0.012188, -0.006875, -0.016875, -0.011563, -0.035313, -0.056250, -0.081875, -0.066563, -0.096250
#*# x_count = 11
#*# y_count = 11
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 28.0
#*# max_x = 220.0
#*# min_y = 6.0
#*# max_y = 199.9
#*#
#*# [probe]
#*# z_offset = 1.200
#*#
#*# [bed_mesh SV06_mesh]
#*# version = 1
#*# points =
#*# 	  -0.087188, -0.083438, -0.060938, -0.040938, -0.051563, -0.056563, -0.085625, -0.097188, -0.110000, -0.094688, -0.150625
#*# 	  -0.105625, -0.105625, -0.083438, -0.072188, -0.083750, -0.088438, -0.118438, -0.135000, -0.153438, -0.133125, -0.209688
#*# 	  -0.095625, -0.078125, -0.053438, -0.040625, -0.048125, -0.044063, -0.064688, -0.079063, -0.111875, -0.111250, -0.195000
#*# 	  -0.086563, -0.068438, -0.042188, -0.028125, -0.035625, -0.031563, -0.046563, -0.057188, -0.085313, -0.082813, -0.153750
#*# 	  -0.096563, -0.082813, -0.059688, -0.046563, -0.051250, -0.044688, -0.057500, -0.063750, -0.082813, -0.081563, -0.128125
#*# 	  -0.097500, -0.086875, -0.065000, -0.054375, -0.058438, -0.048438, -0.057500, -0.066875, -0.085313, -0.079063, -0.127188
#*# 	  -0.092500, -0.081875, -0.060000, -0.043438, -0.045625, -0.039063, -0.053125, -0.063125, -0.084063, -0.073750, -0.132500
#*# 	  -0.085938, -0.080938, -0.058125, -0.042500, -0.050000, -0.031875, -0.047500, -0.061563, -0.083125, -0.073125, -0.127188
#*# 	  -0.078750, -0.070938, -0.049063, -0.040000, -0.040625, -0.027500, -0.047500, -0.060625, -0.084375, -0.071563, -0.111875
#*# 	  -0.057500, -0.055000, -0.035938, -0.026875, -0.032188, -0.020000, -0.041563, -0.057500, -0.078438, -0.064688, -0.105000
#*# 	  -0.024063, -0.027813, -0.012188, -0.006875, -0.016875, -0.011563, -0.035313, -0.056250, -0.081875, -0.066563, -0.096250
#*# x_count = 11
#*# y_count = 11
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 28.0
#*# max_x = 220.0
#*# min_y = 6.0
#*# max_y = 199.9
